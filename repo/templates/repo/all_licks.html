{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block content %}
<button class="search-btn col-lg-12" data-toggle="collapse" data-target="#search">Search <i class="fas fa-search"></i></button>
<div id="search" class="collapse">



  <form method="GET" action=".">

    <div class="time-signature row">
        <div class="col-4">
            {{ form.time_signature|as_crispy_field }}
        </div>
    </div>

    <div class="form-row">
        <div class="row chords-row">
                <div class="separator-lr"></div>
                {{ form.m1_b1|as_crispy_field }}
                {{ form.m1_b2|as_crispy_field }}
                {{ form.m1_b3|as_crispy_field }}
                {{ form.m1_b4|as_crispy_field }}
                <div class="separator-mid"></div>
                {{ form.m2_b1|as_crispy_field }}
                {{ form.m2_b2|as_crispy_field }}
                {{ form.m2_b3|as_crispy_field }}
                {{ form.m2_b4|as_crispy_field }}
                <div class="separator-lr"></div>
        </div>
        <div class="row chords-row">
                <div class="separator-lr"></div>
                {{ form.m3_b1|as_crispy_field }}
                {{ form.m3_b2|as_crispy_field }}
                {{ form.m3_b3|as_crispy_field }}
                {{ form.m3_b4|as_crispy_field }}
                <div class="separator-mid"></div>
                {{ form.m4_b1|as_crispy_field }}
                {{ form.m4_b2|as_crispy_field }}
                {{ form.m4_b3|as_crispy_field }}
                {{ form.m4_b4|as_crispy_field }}
                <div class="separator-lr"></div>
        </div>
    </div>




    <div class="form-row">

      <div class="form-group col-md-4">
        <label for="category">Genre</label>
        <select id="category" class="form-control" name="genre">
          <option selected>Any</option>
          {% for gen in genres %}
          <option value="{{ gen }}">{{ gen }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="form-group col-md-4">
        <label for="category">Instrument</label>
        <select id="category" class="form-control" name="instrument">
          <option selected>Any</option>
          {% for ins in instrument %}
          <option value="{{ ins }}">{{ ins }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="form-group col-md-4">
          <label for="category">Author</label>
          <input class="form-control py-2 border-right-0 border" type="search" name="username_contains" placeholder="username contains...">
      </div>

    </div>

    <button type="submit" class="btn btn-primary">Search</button>
  </form>

</div>


<style type="text/css">

  .lick-section {
  background: #f9f9f9;
  /*background: #ffcccc;*/
  width: 100%;
  padding: 5px;
  border: 2px solid #234444;
  border-radius: 15px;
  margin: 0px 0px 10px 0px;
}


.lick-metadata{
  background: #ccffcc;
}

.lick-display {
  /*background: #ccffcc;*/
  width: 100%;
  height: 60px;
  padding: 5px;
  margin: 0px 0px 0px 0px;
}

.lick-chords {
  /*background: #ccccff;*/
  width: 100%;
  padding: 5px;
  margin: 0px 0px 0px 0px;
}


.lick-chords .chords-row {
  /*background: #ccffff;*/
  width: 100%;
  margin: 0px 0px 0px 0px;
  background-image: url("{% static 'img/staff.png' %}");
  background-size: 100% 100%;
}


.chords-row .chord3 {
    width: 15.33%;
    /*color: #ff0000;*/
    padding: 0px;
    margin: 0px;
}
.chords-row .chord3 img {
  box-sizing: border-box;
  max-width: 100%;
}


.chords-row .chord {
    width: 11.5%;
    /*color: #ff0000;*/
    padding: 0px;
    margin: 0px;
}
.chords-row .chord img {
  box-sizing: border-box;
  max-width: 100%;
}

.separator-mid{
    width: 4%;
}
.separator-lr{
    width: 2%;
}

.icon {
  background: #ffcccc;
  border: 2px solid #234444;
  border-radius: 2px;
  height: 30px;
  margin: 0px;
  padding: 1px;
  text-align: center;
  vertical-align: middle;
  line-height: 30px;
}


.lick-display{
  width: 100%;
  height: 30px;
}

.icon audio {
  width: 100%;
  height: 25px;
}

</style>

{% if licks %}
{% for lick in licks %}
<article class="lick lick-section">

    <div class="lick-icons col-12">
      <div class="row">
        <div class="icon col-3">{{ lick.genre }}</div>
        <div class="icon col-3">{{ lick.instrument }}</div>
        <div class="icon col-3">Like</div>
        <div class="icon col-3">Likes</div>
      </div>

      <div class="row">
        <div class="icon col-3">Lick #{{ lick.id }}</div>
        <div class="icon col-3"><small class="text-muted">{{ lick.author }} #{{ lick.counter }}</small></div>
        <div class="icon col-3"><small class="text-muted">{{ lick.date_posted|date:"Y b d" }}</small></div>
        <div class="icon col-3"><small class="text-muted">15 Likes</small></div>
      </div>
    </div>


    <div class=".lick-display col-12">
      <div class="row">
        <div class="icon col-11">
        <audio controls preload="none">
        <source src="{{ lick.file.url }}" type="audio/mp4" >
        Your browser does not support HTML5 audio. Try Chrome 6+
        </audio>
        </div>
        <div class="icon col-1">
          <select id="transpose" name="transpose">
            <option value="12">+12</option>
            <option value="11">+11</option>
            <option value="10">+10</option>
            <option value="9">+9</option>
            <option value="8">+8</option>
            <option value="7">+7</option>
            <option value="6">+6</option>
            <option value="5">+5</option>
            <option value="4">+4</option>
            <option value="3">+3</option>
            <option value="2">+2</option>
            <option value="1">+1</option>
            <option value="0" selected="selected">T</option>
            <option value="-1">-1</option>
            <option value="-2">-2</option>
            <option value="-3">-3</option>
            <option value="-4">-4</option>
            <option value="-5">-5</option>
            <option value="-6">-6</option>
            <option value="-7">-7</option>
            <option value="-8">-8</option>
            <option value="-9">-9</option>
            <option value="-10">-10</option>
            <option value="-11">-11</option>
            <option value="-12">-12</option>
          </select>
        </div>
      </div>
    </div>

    {% if lick.time_signature == '3/4' %}

    <div class="lick-chords col-12">
        <div class="row chords-row">
          <div class="separator-lr"></div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m1_b1|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m1_b1 }}"/>{% endwith %}</div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m1_b2|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m1_b2 }}"/>{% endwith %}</div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m1_b3|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m1_b3 }}"/>{% endwith %}</div>
          <div class="separator-mid"></div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m2_b1|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m2_b1 }}"/>{% endwith %}</div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m2_b2|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m2_b2 }}"/>{% endwith %}</div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m2_b3|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m2_b3 }}"/>{% endwith %}</div>
          <div class="separator-lr"></div>
        </div>
        <div class="row chords-row">
          <div class="separator-lr"></div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m3_b1|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m3_b1 }}"/>{% endwith %}</div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m3_b2|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m3_b2 }}"/>{% endwith %}</div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m3_b3|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m3_b3 }}"/>{% endwith %}</div>
          <div class="separator-mid"></div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m4_b1|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m4_b1 }}"/>{% endwith %}</div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m4_b2|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m4_b2 }}"/>{% endwith %}</div>
            <div class="chord3">{% with 'img/chords/'|add:lick.m4_b3|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m4_b3 }}"/>{% endwith %}</div>
          <div class="separator-lr"></div>
        </div>
      </div>


    {% else %}

    <div class="lick-chords col-12">
        <div class="row chords-row">
          <div class="separator-lr"></div>
            <div class="chord">{% with 'img/chords/'|add:lick.m1_b1|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m1_b1 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m1_b2|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m1_b2 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m1_b3|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m1_b3 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m1_b4|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m1_b4 }}"/>{% endwith %}</div>
          <div class="separator-mid"></div>
            <div class="chord">{% with 'img/chords/'|add:lick.m2_b1|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m2_b1 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m2_b2|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m2_b2 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m2_b3|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m2_b3 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m2_b4|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m2_b4 }}"/>{% endwith %}</div>
          <div class="separator-lr"></div>
        </div>
        <div class="row chords-row">
          <div class="separator-lr"></div>
            <div class="chord">{% with 'img/chords/'|add:lick.m3_b1|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m3_b1 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m3_b2|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m3_b2 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m3_b3|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m3_b3 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m3_b4|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m3_b4 }}"/>{% endwith %}</div>
          <div class="separator-mid"></div>
            <div class="chord">{% with 'img/chords/'|add:lick.m4_b1|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m4_b1 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m4_b2|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m4_b2 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m4_b3|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m4_b3 }}"/>{% endwith %}</div>
            <div class="chord">{% with 'img/chords/'|add:lick.m4_b4|add:'.png' as image_static %}<img src="{% static image_static %}" alt="{{ lick.m4_b4 }}"/>{% endwith %}</div>
          <div class="separator-lr"></div>
        </div>
    </div>

    {% endif %}

</article>
{% endfor %}

{% else %}

<div class="alert alert-primary" role="alert">
   No licks found... Try searching for something else.
</div>

{% endif %}

{% if is_paginated %}

    {% if page_obj.has_previous %}
      <a class = "btn btn-outline-info mb-4" href="?page=1">First</a>
      <a class = "btn btn-outline-info mb-4" href="?page={{ page_obj.previous_page_number}}">Previous</a>
    {% endif %}

    {% for num in page_obj.paginator.page_range %}
      {% if page_obj.number == num %}
        <a class = "btn btn-info mb-4" href="?page={{ num }}">{{ num }}</a>
      {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3'%}
        <a class = "btn btn-outline-info mb-4" href="?page={{ num }}">{{ num }}</a>
      {% endif %}
    {% endfor %}

    {% if page_obj.has_next %}
      <a class = "btn btn-outline-info mb-4" href="?page={{ page_obj.next_page_number}}">Next</a>
      <a class = "btn btn-outline-info mb-4" href="?page={{ page_obj.paginator.num_pages}}">Last</a>
    {% endif %}

  {% endif %}

{% endblock content %}





